"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/generate-slides/route";
exports.ids = ["app/api/generate-slides/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-slides%2Froute&page=%2Fapi%2Fgenerate-slides%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-slides%2Froute.ts&appDir=%2FUsers%2Fleodrougge%2FDocuments%2FSlide%20Generator%20v0.2%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fleodrougge%2FDocuments%2FSlide%20Generator%20v0.2&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-slides%2Froute&page=%2Fapi%2Fgenerate-slides%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-slides%2Froute.ts&appDir=%2FUsers%2Fleodrougge%2FDocuments%2FSlide%20Generator%20v0.2%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fleodrougge%2FDocuments%2FSlide%20Generator%20v0.2&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_leodrougge_Documents_Slide_Generator_v0_2_app_api_generate_slides_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/generate-slides/route.ts */ \"(rsc)/./app/api/generate-slides/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/generate-slides/route\",\n        pathname: \"/api/generate-slides\",\n        filename: \"route\",\n        bundlePath: \"app/api/generate-slides/route\"\n    },\n    resolvedPagePath: \"/Users/leodrougge/Documents/Slide Generator v0.2/app/api/generate-slides/route.ts\",\n    nextConfigOutput,\n    userland: _Users_leodrougge_Documents_Slide_Generator_v0_2_app_api_generate_slides_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/generate-slides/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnZW5lcmF0ZS1zbGlkZXMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmdlbmVyYXRlLXNsaWRlcyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmdlbmVyYXRlLXNsaWRlcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmxlb2Ryb3VnZ2UlMkZEb2N1bWVudHMlMkZTbGlkZSUyMEdlbmVyYXRvciUyMHYwLjIlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGbGVvZHJvdWdnZSUyRkRvY3VtZW50cyUyRlNsaWRlJTIwR2VuZXJhdG9yJTIwdjAuMiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDaUM7QUFDOUc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbGlkZS1nZW5lcmF0b3IvP2E5MDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2xlb2Ryb3VnZ2UvRG9jdW1lbnRzL1NsaWRlIEdlbmVyYXRvciB2MC4yL2FwcC9hcGkvZ2VuZXJhdGUtc2xpZGVzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9nZW5lcmF0ZS1zbGlkZXMvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9nZW5lcmF0ZS1zbGlkZXNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2dlbmVyYXRlLXNsaWRlcy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9sZW9kcm91Z2dlL0RvY3VtZW50cy9TbGlkZSBHZW5lcmF0b3IgdjAuMi9hcHAvYXBpL2dlbmVyYXRlLXNsaWRlcy9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvZ2VuZXJhdGUtc2xpZGVzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-slides%2Froute&page=%2Fapi%2Fgenerate-slides%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-slides%2Froute.ts&appDir=%2FUsers%2Fleodrougge%2FDocuments%2FSlide%20Generator%20v0.2%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fleodrougge%2FDocuments%2FSlide%20Generator%20v0.2&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/generate-slides/route.ts":
/*!******************************************!*\
  !*** ./app/api/generate-slides/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _anthropic_ai_sdk__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @anthropic-ai/sdk */ \"(rsc)/./node_modules/@anthropic-ai/sdk/index.mjs\");\n\n\nconst anthropic = new _anthropic_ai_sdk__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n    apiKey: process.env.ANTHROPIC_API_KEY || \"\"\n});\nasync function POST(request) {\n    try {\n        const { notes, brief, slideAmountMode, slideAmountMin, slideAmountMax } = await request.json();\n        if (!notes || typeof notes !== \"string\" || !notes.trim()) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Notes are required\"\n            }, {\n                status: 400\n            });\n        }\n        if (!process.env.ANTHROPIC_API_KEY) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"ANTHROPIC_API_KEY is not configured\"\n            }, {\n                status: 500\n            });\n        }\n        // Build prompt with slide count instruction\n        let slideCountInstruction = \"\";\n        let summaryInstruction = \"\";\n        if (slideAmountMode === \"edit\" && typeof slideAmountMin === \"number\" && typeof slideAmountMax === \"number\" && slideAmountMin >= 3 && slideAmountMax <= 32 && slideAmountMin <= slideAmountMax) {\n            if (slideAmountMin === slideAmountMax) {\n                slideCountInstruction = `\\nVIKTIGT: Generera EXAKT ${slideAmountMin} slides. Inte fler, inte färre.`;\n                summaryInstruction = `\\nVIKTIGT: Om innehållet är omfattande (t.ex. många bullet points eller lång text), sammanfatta HÅRT för att passa in i exakt ${slideAmountMin} slides. Kombinera relaterade punkter, sammanfatta detaljer till huvudbudskap, och prioritera det viktigaste innehållet. Det är viktigare att få exakt ${slideAmountMin} slides än att behålla all detaljnivå.`;\n            } else {\n                slideCountInstruction = `\\nVIKTIGT: Generera mellan ${slideAmountMin} och ${slideAmountMax} slides. Antalet ska ligga inom detta spann.`;\n                summaryInstruction = `\\nVIKTIGT: Om innehållet är omfattande (t.ex. många bullet points eller lång text), sammanfatta vid behov för att passa in i mellan ${slideAmountMin} och ${slideAmountMax} slides. Kombinera relaterade punkter, sammanfatta detaljer till huvudbudskap, och prioritera det viktigaste innehållet. Det är viktigare att få antalet slides inom spannet (${slideAmountMin}-${slideAmountMax}) än att behålla all detaljnivå.`;\n            }\n        } else {\n            slideCountInstruction = \"\\nVIKTIGT: Dela upp logiskt i separata slides baserat p\\xe5 \\xe4mnen/avsnitt. G\\xf6r minimala anpassningar och anv\\xe4nd inneh\\xe5llet som det \\xe4r.\";\n            summaryInstruction = \"\\nVIKTIGT: Sammanfatta MINIMALT - anv\\xe4nd prim\\xe4rt inneh\\xe5llet som det \\xe4r.\";\n        }\n        const prompt = `Du ska dela upp dessa anteckningar i slides för en presentation. Varje slide ska ha:\n- overline: Denna kommer automatiskt att sättas till samma som title-sidan (första sliden). Du behöver inte bekymra dig om denna - sätt den alltid till tom sträng (\"\").\n- title: Huvudrubriken för sliden (max 60 tecken) - Detta är huvudbudskapet och den viktiga informationen. Undvik ord över 15 tecken eftersom rubriktypsnittet är stort.\n- bodyText: Huvudinnehållet (2-4 rader, separera med \\\\n för radbrytningar)\n${slideCountInstruction}\n${summaryInstruction}\n\nVIKTIGA REGLER FÖR TEXTFÖRFINING:\n- Du får INTE lägga till någon ny information\n- Du får bara förbättra texten språkligt så att den passar en slidepresentation: kort, tydligt och rakt på sak\n- Behåll betydelsen exakt som i originalet\n- Inga exempel, inga förklaringar, inga nya ord som ändrar innehållet\n- Förfina bara rytm, klarhet och läsbarhet\n\nSTRUKTUR OCH LÄSBARHET:\n- Varje slide ska kunna läsas och förstås självständigt\n- Rubrikerna ska hänga ihop som en logisk kedja – men varje rubrik ska också vara fullt begriplig på egen hand\n\nVIKTIGT: \n- Första sliden ska vara en titelsida med temat för presentationen\n  - overline: Sätt till tom sträng (\"\")\n  - title: Huvudtemat/titeln för presentationen\n  - bodyText: Lämna tom eller en kort beskrivning av vad presentationen handlar om\n  - layout: \"title\"\n- Om presentationen är längre än 5 slides, ska slide 2 använda \"intro\" layout och innehålla en sammanfattning av hela presentationen i ett stycke i bodyText. Denna slide fungerar som en översikt över innehållet.\n  - layout: \"intro\" för slide 2 när presentationen är längre än 5 slides\n  - title: Lämna tom (intro-layout använder inte title)\n  - bodyText: Skriv ett enda kort stycke utan rubrik eller punktlistor. Undvik allt metaprat: inget \"presentationen\", \"vi\", \"fokuserar på\", \"handlar om\" eller liknande. Skriv bara själva innehållets kärna som ett direkt konstaterande, i enkelt och lättläst språk. Ingen ny information.\n- Slide 3 ska vara en innehållsförteckning (TOC) med avdelningsrubriker när presentationen är längre än 5 slides.\n  - layout: \"toc\" för TOC-sliden\n  - title: \"Innehållsförteckning\"\n  - bodyText: Lista av avdelningsrubriker (en per rad, kommer att formateras som numrerad lista)\n- För att strukturera presentationen: använd \"avdelare\" layout för avdelningsrubriker (t.ex. \"Del 1\", \"Strategi\", \"Resultat\"). Dessa slides ska ha ljusgrå bakgrund och fungerar som avdelningar i presentationen.\n  - layout: \"avdelare\" för avdelningsrubriker\n  - title: Avdelningsrubriken\n  - bodyText: Lämna tom eller kort beskrivning\n- Övriga slides: Använd faktiskt innehåll från anteckningarna - förfina språket om det behövs för att förbättra klarhet och rytm, men hitta inte på saker. Standard-layout för vanliga slides är \"quadrant-1-2-large\".\n  - layout: \"quadrant-1-2-large\" för vanliga slides (inte title, intro, avdelare eller TOC)\n  - Om innehållet är i punktform (flera rader/poänger), sätt useBullets: true\n- Sätt alltid overline till tom sträng (\"\"). Den kommer automatiskt att uppdateras i systemet.\n\nAnteckningar:\n${notes}\n\nReturnera JSON-array med SlideState objekt i formatet:\n[\n  {\n    \"overline\": \"\",\n    \"title\": \"...\",\n    \"bodyText\": \"...\",\n    \"layout\": \"title\"\n  },\n  {\n    \"overline\": \"\",\n    \"title\": \"\",\n    \"bodyText\": \"Sammanfattning av presentationen i ett stycke...\",\n    \"layout\": \"intro\"\n  },\n  {\n    \"overline\": \"\",\n    \"title\": \"...\",\n    \"bodyText\": \"...\",\n    \"layout\": \"avdelare\"\n  },\n  {\n    \"overline\": \"\",\n    \"title\": \"...\",\n    \"bodyText\": \"...\",\n    \"layout\": \"quadrant-1-2-large\",\n    \"useBullets\": false\n  },\n  ...\n]\n\nAnvänd \"title\" för titelsidan, \"intro\" för slide 2 om presentationen är längre än 5 slides, \"toc\" för innehållsförteckning, \"avdelare\" för avdelningsrubriker, och \"quadrant-1-2-large\" för alla andra slides. Om innehållet är i punktform, sätt useBullets: true. Sätt overline till tom sträng (\"\"). Returnera ENDAST JSON, ingen ytterligare text.`;\n        // Add brief to prompt if provided\n        let fullPrompt = prompt;\n        if (brief && typeof brief === \"string\" && brief.trim()) {\n            fullPrompt = `BRIEF/KONTEXT:\n${brief.trim()}\n\n${prompt}`;\n        }\n        // Try Claude 4.5 Sonnet first, then fallback to 3.5\n        let message;\n        const modelsToTry = [\n            \"claude-sonnet-4-5\",\n            \"claude-sonnet-4-5-20241022\",\n            \"claude-4-5-sonnet\",\n            \"claude-3-5-sonnet-20241022\",\n            \"claude-3-5-sonnet-20240620\",\n            \"claude-3-5-sonnet\"\n        ];\n        let lastError = null;\n        for (const model of modelsToTry){\n            try {\n                message = await anthropic.messages.create({\n                    model: model,\n                    max_tokens: 4096,\n                    messages: [\n                        {\n                            role: \"user\",\n                            content: fullPrompt\n                        }\n                    ]\n                });\n                console.log(`Successfully used model: ${model}`);\n                break; // Success, exit loop\n            } catch (error) {\n                lastError = error;\n                console.warn(`Failed with ${model}, trying next...`, error.message);\n                continue;\n            }\n        }\n        if (!message) {\n            throw new Error(`All models failed. Last error: ${lastError?.message || \"Unknown error\"}`);\n        }\n        const content = message.content[0];\n        if (content.type !== \"text\") {\n            throw new Error(\"Unexpected response type from Claude\");\n        }\n        // Extract JSON from response (might have markdown code blocks)\n        let jsonText = content.text.trim();\n        // Remove markdown code blocks if present\n        if (jsonText.startsWith(\"```\")) {\n            jsonText = jsonText.replace(/^```json\\s*/i, \"\").replace(/^```\\s*/, \"\").replace(/```\\s*$/g, \"\").trim();\n        }\n        // Try to extract JSON array if there's extra text\n        const jsonMatch = jsonText.match(/\\[[\\s\\S]*\\]/);\n        if (jsonMatch) {\n            jsonText = jsonMatch[0];\n        }\n        let slides;\n        try {\n            slides = JSON.parse(jsonText);\n        } catch (parseError) {\n            console.error(\"JSON parse error:\", parseError);\n            console.error(\"Text to parse:\", jsonText.substring(0, 500));\n            throw new Error(`Failed to parse Claude response as JSON: ${parseError.message}`);\n        }\n        if (!Array.isArray(slides) || slides.length === 0) {\n            throw new Error(\"Claude did not return a valid array of slides\");\n        }\n        // Validate and set default layout if missing\n        const validatedSlides = slides.map((slide, index)=>{\n            if (!slide || typeof slide !== \"object\") {\n                throw new Error(`Invalid slide at index ${index}`);\n            }\n            // Determine default layout\n            let defaultLayout;\n            if (index === 0) {\n                defaultLayout = \"title\"; // First slide is always title\n            } else {\n                defaultLayout = \"quadrant-1-2-large\"; // Default for other slides\n            }\n            // Detect if bodyText is in bullet point format (multiple lines)\n            const bodyText = slide.bodyText || \"\";\n            const isBulletFormat = bodyText.split(\"\\n\").filter((line)=>line.trim()).length > 1;\n            return {\n                overline: slide.overline || \"\",\n                title: slide.title || \"\",\n                bodyText: bodyText,\n                layout: slide.layout || defaultLayout,\n                // Set useBullets to true if content is in bullet format, or if explicitly set\n                useBullets: slide.useBullets !== undefined ? slide.useBullets : isBulletFormat\n            };\n        });\n        // Set overline on all slides to match title slide's title\n        const titleSlideTitle = validatedSlides[0]?.title || \"\";\n        validatedSlides.forEach((slide)=>{\n            slide.overline = titleSlideTitle;\n        });\n        // If more than 5 slides, ensure intro (slide 2) and TOC (slide 3) exist\n        if (validatedSlides.length > 5) {\n            const slide2 = validatedSlides[1]; // Slide 2 (index 1)\n            const slide3 = validatedSlides[2]; // Slide 3 (index 2)\n            // Ensure slide 2 is an intro slide\n            if (!slide2 || slide2.layout !== \"intro\") {\n                // Create intro slide with summary - Claude should have created this,\n                // but if not, we'll create a placeholder that needs manual editing\n                const introSlide = {\n                    overline: titleSlideTitle,\n                    title: \"\",\n                    bodyText: slide2?.bodyText || \"Sammanfattning av presentationen kommer h\\xe4r...\",\n                    layout: \"intro\",\n                    useBullets: false\n                };\n                // Replace slide 2 with intro slide, or insert if missing\n                if (slide2) {\n                    validatedSlides[1] = introSlide;\n                } else {\n                    validatedSlides.splice(1, 0, introSlide);\n                }\n            }\n            // Ensure slide 3 is a TOC slide (after intro)\n            // Get titles from \"avdelare\" slides for TOC (section dividers)\n            // Skip title slide (index 0) and intro slide (index 1), then filter for \"avdelare\" layout slides\n            const tocTitles = validatedSlides.slice(2) // Skip title slide and intro slide\n            .filter((slide)=>slide.layout === \"avdelare\").map((slide)=>slide.title).filter((title)=>title.trim());\n            // If no avdelare slides found, fall back to all slide titles (except title and intro slides)\n            const finalTocTitles = tocTitles.length > 0 ? tocTitles : validatedSlides.slice(2) // Skip title slide and intro slide\n            .map((slide)=>slide.title).filter((title)=>title.trim());\n            // Check if slide 3 is already a TOC slide\n            const isTocSlide = slide3?.title === \"Inneh\\xe5llsf\\xf6rteckning\" || slide3?.layout === \"toc\";\n            if (!slide3 || !isTocSlide) {\n                // Create TOC slide with same structure as validatedSlides\n                const tocSlide = {\n                    overline: titleSlideTitle,\n                    title: \"Inneh\\xe5llsf\\xf6rteckning\",\n                    bodyText: finalTocTitles.join(\"\\n\"),\n                    layout: \"toc\",\n                    useBullets: false\n                };\n                // Replace slide 3 with TOC slide, or insert if missing\n                if (slide3) {\n                    validatedSlides[2] = tocSlide;\n                } else {\n                    validatedSlides.splice(2, 0, tocSlide);\n                }\n            } else {\n                // Update existing TOC slide content\n                slide3.bodyText = finalTocTitles.join(\"\\n\");\n                slide3.layout = \"toc\";\n                slide3.useBullets = false; // TOC uses numbered list, not bullets\n            }\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            slides: validatedSlides\n        });\n    } catch (error) {\n        console.error(\"Error in generate-slides API:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message || \"Failed to generate slides\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRSxHQUFHeUI7Z0JBQ3ZCLE9BQU87b0JBQ0x6QixnQkFBZ0JvQixNQUFNLENBQUMsR0FBRyxHQUFHSztnQkFDL0I7WUFDRixPQUFPO2dCQUNMLG9DQUFvQztnQkFDcENQLE9BQU9iLFFBQVEsR0FBR2tCLGVBQWVHLElBQUksQ0FBQztnQkFDdENSLE9BQU9OLE1BQU0sR0FBRztnQkFDaEJNLE9BQU9MLFVBQVUsR0FBRyxPQUFPLHNDQUFzQztZQUNuRTtRQUNGO1FBRUEsT0FBTy9ELHFEQUFZQSxDQUFDYyxJQUFJLENBQUM7WUFBRTRCLFFBQVFRO1FBQWdCO0lBQ3JELEVBQUUsT0FBT2xDLE9BQVk7UUFDbkJlLFFBQVFmLEtBQUssQ0FBQyxpQ0FBaUNBO1FBQy9DLE9BQU9oQixxREFBWUEsQ0FBQ2MsSUFBSSxDQUN0QjtZQUFFRSxPQUFPQSxNQUFNTSxPQUFPLElBQUk7UUFBNEIsR0FDdEQ7WUFBRUwsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbGlkZS1nZW5lcmF0b3IvLi9hcHAvYXBpL2dlbmVyYXRlLXNsaWRlcy9yb3V0ZS50cz9lMjY0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgQW50aHJvcGljIGZyb20gJ0BhbnRocm9waWMtYWkvc2RrJztcbmltcG9ydCB0eXBlIHsgU2xpZGVTdGF0ZSB9IGZyb20gJy4uLy4uL2xpYi90eXBlcyc7XG5cbmNvbnN0IGFudGhyb3BpYyA9IG5ldyBBbnRocm9waWMoe1xuICBhcGlLZXk6IHByb2Nlc3MuZW52LkFOVEhST1BJQ19BUElfS0VZIHx8ICcnLFxufSk7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBub3RlcywgYnJpZWYsIHNsaWRlQW1vdW50TW9kZSwgc2xpZGVBbW91bnRNaW4sIHNsaWRlQW1vdW50TWF4IH0gPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcblxuICAgIGlmICghbm90ZXMgfHwgdHlwZW9mIG5vdGVzICE9PSAnc3RyaW5nJyB8fCAhbm90ZXMudHJpbSgpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdOb3RlcyBhcmUgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoIXByb2Nlc3MuZW52LkFOVEhST1BJQ19BUElfS0VZKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdBTlRIUk9QSUNfQVBJX0tFWSBpcyBub3QgY29uZmlndXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIEJ1aWxkIHByb21wdCB3aXRoIHNsaWRlIGNvdW50IGluc3RydWN0aW9uXG4gICAgbGV0IHNsaWRlQ291bnRJbnN0cnVjdGlvbiA9ICcnO1xuICAgIGxldCBzdW1tYXJ5SW5zdHJ1Y3Rpb24gPSAnJztcbiAgICBpZiAoc2xpZGVBbW91bnRNb2RlID09PSAnZWRpdCcgJiYgdHlwZW9mIHNsaWRlQW1vdW50TWluID09PSAnbnVtYmVyJyAmJiB0eXBlb2Ygc2xpZGVBbW91bnRNYXggPT09ICdudW1iZXInIFxuICAgICAgICAmJiBzbGlkZUFtb3VudE1pbiA+PSAzICYmIHNsaWRlQW1vdW50TWF4IDw9IDMyICYmIHNsaWRlQW1vdW50TWluIDw9IHNsaWRlQW1vdW50TWF4KSB7XG4gICAgICBpZiAoc2xpZGVBbW91bnRNaW4gPT09IHNsaWRlQW1vdW50TWF4KSB7XG4gICAgICAgIHNsaWRlQ291bnRJbnN0cnVjdGlvbiA9IGBcXG5WSUtUSUdUOiBHZW5lcmVyYSBFWEFLVCAke3NsaWRlQW1vdW50TWlufSBzbGlkZXMuIEludGUgZmxlciwgaW50ZSBmw6RycmUuYDtcbiAgICAgICAgc3VtbWFyeUluc3RydWN0aW9uID0gYFxcblZJS1RJR1Q6IE9tIGlubmVow6VsbGV0IMOkciBvbWZhdHRhbmRlICh0LmV4LiBtw6VuZ2EgYnVsbGV0IHBvaW50cyBlbGxlciBsw6VuZyB0ZXh0KSwgc2FtbWFuZmF0dGEgSMOFUlQgZsO2ciBhdHQgcGFzc2EgaW4gaSBleGFrdCAke3NsaWRlQW1vdW50TWlufSBzbGlkZXMuIEtvbWJpbmVyYSByZWxhdGVyYWRlIHB1bmt0ZXIsIHNhbW1hbmZhdHRhIGRldGFsamVyIHRpbGwgaHV2dWRidWRza2FwLCBvY2ggcHJpb3JpdGVyYSBkZXQgdmlrdGlnYXN0ZSBpbm5laMOlbGxldC4gRGV0IMOkciB2aWt0aWdhcmUgYXR0IGbDpSBleGFrdCAke3NsaWRlQW1vdW50TWlufSBzbGlkZXMgw6RuIGF0dCBiZWjDpWxsYSBhbGwgZGV0YWxqbml2w6UuYDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNsaWRlQ291bnRJbnN0cnVjdGlvbiA9IGBcXG5WSUtUSUdUOiBHZW5lcmVyYSBtZWxsYW4gJHtzbGlkZUFtb3VudE1pbn0gb2NoICR7c2xpZGVBbW91bnRNYXh9IHNsaWRlcy4gQW50YWxldCBza2EgbGlnZ2EgaW5vbSBkZXR0YSBzcGFubi5gO1xuICAgICAgICBzdW1tYXJ5SW5zdHJ1Y3Rpb24gPSBgXFxuVklLVElHVDogT20gaW5uZWjDpWxsZXQgw6RyIG9tZmF0dGFuZGUgKHQuZXguIG3DpW5nYSBidWxsZXQgcG9pbnRzIGVsbGVyIGzDpW5nIHRleHQpLCBzYW1tYW5mYXR0YSB2aWQgYmVob3YgZsO2ciBhdHQgcGFzc2EgaW4gaSBtZWxsYW4gJHtzbGlkZUFtb3VudE1pbn0gb2NoICR7c2xpZGVBbW91bnRNYXh9IHNsaWRlcy4gS29tYmluZXJhIHJlbGF0ZXJhZGUgcHVua3Rlciwgc2FtbWFuZmF0dGEgZGV0YWxqZXIgdGlsbCBodXZ1ZGJ1ZHNrYXAsIG9jaCBwcmlvcml0ZXJhIGRldCB2aWt0aWdhc3RlIGlubmVow6VsbGV0LiBEZXQgw6RyIHZpa3RpZ2FyZSBhdHQgZsOlIGFudGFsZXQgc2xpZGVzIGlub20gc3Bhbm5ldCAoJHtzbGlkZUFtb3VudE1pbn0tJHtzbGlkZUFtb3VudE1heH0pIMOkbiBhdHQgYmVow6VsbGEgYWxsIGRldGFsam5pdsOlLmA7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHNsaWRlQ291bnRJbnN0cnVjdGlvbiA9ICdcXG5WSUtUSUdUOiBEZWxhIHVwcCBsb2dpc2t0IGkgc2VwYXJhdGEgc2xpZGVzIGJhc2VyYXQgcMOlIMOkbW5lbi9hdnNuaXR0LiBHw7ZyIG1pbmltYWxhIGFucGFzc25pbmdhciBvY2ggYW52w6RuZCBpbm5laMOlbGxldCBzb20gZGV0IMOkci4nO1xuICAgICAgc3VtbWFyeUluc3RydWN0aW9uID0gJ1xcblZJS1RJR1Q6IFNhbW1hbmZhdHRhIE1JTklNQUxUIC0gYW52w6RuZCBwcmltw6RydCBpbm5laMOlbGxldCBzb20gZGV0IMOkci4nO1xuICAgIH1cblxuICAgIGNvbnN0IHByb21wdCA9IGBEdSBza2EgZGVsYSB1cHAgZGVzc2EgYW50ZWNrbmluZ2FyIGkgc2xpZGVzIGbDtnIgZW4gcHJlc2VudGF0aW9uLiBWYXJqZSBzbGlkZSBza2EgaGE6XG4tIG92ZXJsaW5lOiBEZW5uYSBrb21tZXIgYXV0b21hdGlza3QgYXR0IHPDpHR0YXMgdGlsbCBzYW1tYSBzb20gdGl0bGUtc2lkYW4gKGbDtnJzdGEgc2xpZGVuKS4gRHUgYmVow7Z2ZXIgaW50ZSBiZWt5bXJhIGRpZyBvbSBkZW5uYSAtIHPDpHR0IGRlbiBhbGx0aWQgdGlsbCB0b20gc3Ryw6RuZyAoXCJcIikuXG4tIHRpdGxlOiBIdXZ1ZHJ1YnJpa2VuIGbDtnIgc2xpZGVuIChtYXggNjAgdGVja2VuKSAtIERldHRhIMOkciBodXZ1ZGJ1ZHNrYXBldCBvY2ggZGVuIHZpa3RpZ2EgaW5mb3JtYXRpb25lbi4gVW5kdmlrIG9yZCDDtnZlciAxNSB0ZWNrZW4gZWZ0ZXJzb20gcnVicmlrdHlwc25pdHRldCDDpHIgc3RvcnQuXG4tIGJvZHlUZXh0OiBIdXZ1ZGlubmVow6VsbGV0ICgyLTQgcmFkZXIsIHNlcGFyZXJhIG1lZCBcXFxcbiBmw7ZyIHJhZGJyeXRuaW5nYXIpXG4ke3NsaWRlQ291bnRJbnN0cnVjdGlvbn1cbiR7c3VtbWFyeUluc3RydWN0aW9ufVxuXG5WSUtUSUdBIFJFR0xFUiBGw5ZSIFRFWFRGw5ZSRklOSU5HOlxuLSBEdSBmw6VyIElOVEUgbMOkZ2dhIHRpbGwgbsOlZ29uIG55IGluZm9ybWF0aW9uXG4tIER1IGbDpXIgYmFyYSBmw7ZyYsOkdHRyYSB0ZXh0ZW4gc3Byw6VrbGlndCBzw6UgYXR0IGRlbiBwYXNzYXIgZW4gc2xpZGVwcmVzZW50YXRpb246IGtvcnQsIHR5ZGxpZ3Qgb2NoIHJha3QgcMOlIHNha1xuLSBCZWjDpWxsIGJldHlkZWxzZW4gZXhha3Qgc29tIGkgb3JpZ2luYWxldFxuLSBJbmdhIGV4ZW1wZWwsIGluZ2EgZsO2cmtsYXJpbmdhciwgaW5nYSBueWEgb3JkIHNvbSDDpG5kcmFyIGlubmVow6VsbGV0XG4tIEbDtnJmaW5hIGJhcmEgcnl0bSwga2xhcmhldCBvY2ggbMOkc2JhcmhldFxuXG5TVFJVS1RVUiBPQ0ggTMOEU0JBUkhFVDpcbi0gVmFyamUgc2xpZGUgc2thIGt1bm5hIGzDpHNhcyBvY2ggZsO2cnN0w6VzIHNqw6RsdnN0w6RuZGlndFxuLSBSdWJyaWtlcm5hIHNrYSBow6RuZ2EgaWhvcCBzb20gZW4gbG9naXNrIGtlZGphIOKAkyBtZW4gdmFyamUgcnVicmlrIHNrYSBvY2tzw6UgdmFyYSBmdWxsdCBiZWdyaXBsaWcgcMOlIGVnZW4gaGFuZFxuXG5WSUtUSUdUOiBcbi0gRsO2cnN0YSBzbGlkZW4gc2thIHZhcmEgZW4gdGl0ZWxzaWRhIG1lZCB0ZW1hdCBmw7ZyIHByZXNlbnRhdGlvbmVuXG4gIC0gb3ZlcmxpbmU6IFPDpHR0IHRpbGwgdG9tIHN0csOkbmcgKFwiXCIpXG4gIC0gdGl0bGU6IEh1dnVkdGVtYXQvdGl0ZWxuIGbDtnIgcHJlc2VudGF0aW9uZW5cbiAgLSBib2R5VGV4dDogTMOkbW5hIHRvbSBlbGxlciBlbiBrb3J0IGJlc2tyaXZuaW5nIGF2IHZhZCBwcmVzZW50YXRpb25lbiBoYW5kbGFyIG9tXG4gIC0gbGF5b3V0OiBcInRpdGxlXCJcbi0gT20gcHJlc2VudGF0aW9uZW4gw6RyIGzDpG5ncmUgw6RuIDUgc2xpZGVzLCBza2Egc2xpZGUgMiBhbnbDpG5kYSBcImludHJvXCIgbGF5b3V0IG9jaCBpbm5laMOlbGxhIGVuIHNhbW1hbmZhdHRuaW5nIGF2IGhlbGEgcHJlc2VudGF0aW9uZW4gaSBldHQgc3R5Y2tlIGkgYm9keVRleHQuIERlbm5hIHNsaWRlIGZ1bmdlcmFyIHNvbSBlbiDDtnZlcnNpa3Qgw7Z2ZXIgaW5uZWjDpWxsZXQuXG4gIC0gbGF5b3V0OiBcImludHJvXCIgZsO2ciBzbGlkZSAyIG7DpHIgcHJlc2VudGF0aW9uZW4gw6RyIGzDpG5ncmUgw6RuIDUgc2xpZGVzXG4gIC0gdGl0bGU6IEzDpG1uYSB0b20gKGludHJvLWxheW91dCBhbnbDpG5kZXIgaW50ZSB0aXRsZSlcbiAgLSBib2R5VGV4dDogU2tyaXYgZXR0IGVuZGEga29ydCBzdHlja2UgdXRhbiBydWJyaWsgZWxsZXIgcHVua3RsaXN0b3IuIFVuZHZpayBhbGx0IG1ldGFwcmF0OiBpbmdldCBcInByZXNlbnRhdGlvbmVuXCIsIFwidmlcIiwgXCJmb2t1c2VyYXIgcMOlXCIsIFwiaGFuZGxhciBvbVwiIGVsbGVyIGxpa25hbmRlLiBTa3JpdiBiYXJhIHNqw6RsdmEgaW5uZWjDpWxsZXRzIGvDpHJuYSBzb20gZXR0IGRpcmVrdCBrb25zdGF0ZXJhbmRlLCBpIGVua2VsdCBvY2ggbMOkdHRsw6RzdCBzcHLDpWsuIEluZ2VuIG55IGluZm9ybWF0aW9uLlxuLSBTbGlkZSAzIHNrYSB2YXJhIGVuIGlubmVow6VsbHNmw7ZydGVja25pbmcgKFRPQykgbWVkIGF2ZGVsbmluZ3NydWJyaWtlciBuw6RyIHByZXNlbnRhdGlvbmVuIMOkciBsw6RuZ3JlIMOkbiA1IHNsaWRlcy5cbiAgLSBsYXlvdXQ6IFwidG9jXCIgZsO2ciBUT0Mtc2xpZGVuXG4gIC0gdGl0bGU6IFwiSW5uZWjDpWxsc2bDtnJ0ZWNrbmluZ1wiXG4gIC0gYm9keVRleHQ6IExpc3RhIGF2IGF2ZGVsbmluZ3NydWJyaWtlciAoZW4gcGVyIHJhZCwga29tbWVyIGF0dCBmb3JtYXRlcmFzIHNvbSBudW1yZXJhZCBsaXN0YSlcbi0gRsO2ciBhdHQgc3RydWt0dXJlcmEgcHJlc2VudGF0aW9uZW46IGFudsOkbmQgXCJhdmRlbGFyZVwiIGxheW91dCBmw7ZyIGF2ZGVsbmluZ3NydWJyaWtlciAodC5leC4gXCJEZWwgMVwiLCBcIlN0cmF0ZWdpXCIsIFwiUmVzdWx0YXRcIikuIERlc3NhIHNsaWRlcyBza2EgaGEgbGp1c2dyw6UgYmFrZ3J1bmQgb2NoIGZ1bmdlcmFyIHNvbSBhdmRlbG5pbmdhciBpIHByZXNlbnRhdGlvbmVuLlxuICAtIGxheW91dDogXCJhdmRlbGFyZVwiIGbDtnIgYXZkZWxuaW5nc3J1YnJpa2VyXG4gIC0gdGl0bGU6IEF2ZGVsbmluZ3NydWJyaWtlblxuICAtIGJvZHlUZXh0OiBMw6RtbmEgdG9tIGVsbGVyIGtvcnQgYmVza3Jpdm5pbmdcbi0gw5Z2cmlnYSBzbGlkZXM6IEFudsOkbmQgZmFrdGlza3QgaW5uZWjDpWxsIGZyw6VuIGFudGVja25pbmdhcm5hIC0gZsO2cmZpbmEgc3Byw6VrZXQgb20gZGV0IGJlaMO2dnMgZsO2ciBhdHQgZsO2cmLDpHR0cmEga2xhcmhldCBvY2ggcnl0bSwgbWVuIGhpdHRhIGludGUgcMOlIHNha2VyLiBTdGFuZGFyZC1sYXlvdXQgZsO2ciB2YW5saWdhIHNsaWRlcyDDpHIgXCJxdWFkcmFudC0xLTItbGFyZ2VcIi5cbiAgLSBsYXlvdXQ6IFwicXVhZHJhbnQtMS0yLWxhcmdlXCIgZsO2ciB2YW5saWdhIHNsaWRlcyAoaW50ZSB0aXRsZSwgaW50cm8sIGF2ZGVsYXJlIGVsbGVyIFRPQylcbiAgLSBPbSBpbm5laMOlbGxldCDDpHIgaSBwdW5rdGZvcm0gKGZsZXJhIHJhZGVyL3Bvw6RuZ2VyKSwgc8OkdHQgdXNlQnVsbGV0czogdHJ1ZVxuLSBTw6R0dCBhbGx0aWQgb3ZlcmxpbmUgdGlsbCB0b20gc3Ryw6RuZyAoXCJcIikuIERlbiBrb21tZXIgYXV0b21hdGlza3QgYXR0IHVwcGRhdGVyYXMgaSBzeXN0ZW1ldC5cblxuQW50ZWNrbmluZ2FyOlxuJHtub3Rlc31cblxuUmV0dXJuZXJhIEpTT04tYXJyYXkgbWVkIFNsaWRlU3RhdGUgb2JqZWt0IGkgZm9ybWF0ZXQ6XG5bXG4gIHtcbiAgICBcIm92ZXJsaW5lXCI6IFwiXCIsXG4gICAgXCJ0aXRsZVwiOiBcIi4uLlwiLFxuICAgIFwiYm9keVRleHRcIjogXCIuLi5cIixcbiAgICBcImxheW91dFwiOiBcInRpdGxlXCJcbiAgfSxcbiAge1xuICAgIFwib3ZlcmxpbmVcIjogXCJcIixcbiAgICBcInRpdGxlXCI6IFwiXCIsXG4gICAgXCJib2R5VGV4dFwiOiBcIlNhbW1hbmZhdHRuaW5nIGF2IHByZXNlbnRhdGlvbmVuIGkgZXR0IHN0eWNrZS4uLlwiLFxuICAgIFwibGF5b3V0XCI6IFwiaW50cm9cIlxuICB9LFxuICB7XG4gICAgXCJvdmVybGluZVwiOiBcIlwiLFxuICAgIFwidGl0bGVcIjogXCIuLi5cIixcbiAgICBcImJvZHlUZXh0XCI6IFwiLi4uXCIsXG4gICAgXCJsYXlvdXRcIjogXCJhdmRlbGFyZVwiXG4gIH0sXG4gIHtcbiAgICBcIm92ZXJsaW5lXCI6IFwiXCIsXG4gICAgXCJ0aXRsZVwiOiBcIi4uLlwiLFxuICAgIFwiYm9keVRleHRcIjogXCIuLi5cIixcbiAgICBcImxheW91dFwiOiBcInF1YWRyYW50LTEtMi1sYXJnZVwiLFxuICAgIFwidXNlQnVsbGV0c1wiOiBmYWxzZVxuICB9LFxuICAuLi5cbl1cblxuQW52w6RuZCBcInRpdGxlXCIgZsO2ciB0aXRlbHNpZGFuLCBcImludHJvXCIgZsO2ciBzbGlkZSAyIG9tIHByZXNlbnRhdGlvbmVuIMOkciBsw6RuZ3JlIMOkbiA1IHNsaWRlcywgXCJ0b2NcIiBmw7ZyIGlubmVow6VsbHNmw7ZydGVja25pbmcsIFwiYXZkZWxhcmVcIiBmw7ZyIGF2ZGVsbmluZ3NydWJyaWtlciwgb2NoIFwicXVhZHJhbnQtMS0yLWxhcmdlXCIgZsO2ciBhbGxhIGFuZHJhIHNsaWRlcy4gT20gaW5uZWjDpWxsZXQgw6RyIGkgcHVua3Rmb3JtLCBzw6R0dCB1c2VCdWxsZXRzOiB0cnVlLiBTw6R0dCBvdmVybGluZSB0aWxsIHRvbSBzdHLDpG5nIChcIlwiKS4gUmV0dXJuZXJhIEVOREFTVCBKU09OLCBpbmdlbiB5dHRlcmxpZ2FyZSB0ZXh0LmA7XG5cbiAgICAvLyBBZGQgYnJpZWYgdG8gcHJvbXB0IGlmIHByb3ZpZGVkXG4gICAgbGV0IGZ1bGxQcm9tcHQgPSBwcm9tcHQ7XG4gICAgaWYgKGJyaWVmICYmIHR5cGVvZiBicmllZiA9PT0gJ3N0cmluZycgJiYgYnJpZWYudHJpbSgpKSB7XG4gICAgICBmdWxsUHJvbXB0ID0gYEJSSUVGL0tPTlRFWFQ6XG4ke2JyaWVmLnRyaW0oKX1cblxuJHtwcm9tcHR9YDtcbiAgICB9XG5cbiAgICAvLyBUcnkgQ2xhdWRlIDQuNSBTb25uZXQgZmlyc3QsIHRoZW4gZmFsbGJhY2sgdG8gMy41XG4gICAgbGV0IG1lc3NhZ2U7XG4gICAgY29uc3QgbW9kZWxzVG9UcnkgPSBbXG4gICAgICAnY2xhdWRlLXNvbm5ldC00LTUnLFxuICAgICAgJ2NsYXVkZS1zb25uZXQtNC01LTIwMjQxMDIyJyxcbiAgICAgICdjbGF1ZGUtNC01LXNvbm5ldCcsXG4gICAgICAnY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjInLFxuICAgICAgJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQwNjIwJyxcbiAgICAgICdjbGF1ZGUtMy01LXNvbm5ldCcsXG4gICAgXTtcblxuICAgIGxldCBsYXN0RXJyb3I6IGFueSA9IG51bGw7XG4gICAgZm9yIChjb25zdCBtb2RlbCBvZiBtb2RlbHNUb1RyeSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbWVzc2FnZSA9IGF3YWl0IGFudGhyb3BpYy5tZXNzYWdlcy5jcmVhdGUoe1xuICAgICAgICAgIG1vZGVsOiBtb2RlbCxcbiAgICAgICAgICBtYXhfdG9rZW5zOiA0MDk2LFxuICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bGxQcm9tcHQsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGBTdWNjZXNzZnVsbHkgdXNlZCBtb2RlbDogJHttb2RlbH1gKTtcbiAgICAgICAgYnJlYWs7IC8vIFN1Y2Nlc3MsIGV4aXQgbG9vcFxuICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICBsYXN0RXJyb3IgPSBlcnJvcjtcbiAgICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgd2l0aCAke21vZGVsfSwgdHJ5aW5nIG5leHQuLi5gLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFtZXNzYWdlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEFsbCBtb2RlbHMgZmFpbGVkLiBMYXN0IGVycm9yOiAke2xhc3RFcnJvcj8ubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgY29udGVudCA9IG1lc3NhZ2UuY29udGVudFswXTtcbiAgICBpZiAoY29udGVudC50eXBlICE9PSAndGV4dCcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVW5leHBlY3RlZCByZXNwb25zZSB0eXBlIGZyb20gQ2xhdWRlJyk7XG4gICAgfVxuXG4gICAgLy8gRXh0cmFjdCBKU09OIGZyb20gcmVzcG9uc2UgKG1pZ2h0IGhhdmUgbWFya2Rvd24gY29kZSBibG9ja3MpXG4gICAgbGV0IGpzb25UZXh0ID0gY29udGVudC50ZXh0LnRyaW0oKTtcbiAgICBcbiAgICAvLyBSZW1vdmUgbWFya2Rvd24gY29kZSBibG9ja3MgaWYgcHJlc2VudFxuICAgIGlmIChqc29uVGV4dC5zdGFydHNXaXRoKCdgYGAnKSkge1xuICAgICAganNvblRleHQgPSBqc29uVGV4dC5yZXBsYWNlKC9eYGBganNvblxccyovaSwgJycpLnJlcGxhY2UoL15gYGBcXHMqLywgJycpLnJlcGxhY2UoL2BgYFxccyokL2csICcnKS50cmltKCk7XG4gICAgfVxuICAgIFxuICAgIC8vIFRyeSB0byBleHRyYWN0IEpTT04gYXJyYXkgaWYgdGhlcmUncyBleHRyYSB0ZXh0XG4gICAgY29uc3QganNvbk1hdGNoID0ganNvblRleHQubWF0Y2goL1xcW1tcXHNcXFNdKlxcXS8pO1xuICAgIGlmIChqc29uTWF0Y2gpIHtcbiAgICAgIGpzb25UZXh0ID0ganNvbk1hdGNoWzBdO1xuICAgIH1cblxuICAgIGxldCBzbGlkZXM6IFNsaWRlU3RhdGVbXTtcbiAgICB0cnkge1xuICAgICAgc2xpZGVzID0gSlNPTi5wYXJzZShqc29uVGV4dCkgYXMgU2xpZGVTdGF0ZVtdO1xuICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignSlNPTiBwYXJzZSBlcnJvcjonLCBwYXJzZUVycm9yKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RleHQgdG8gcGFyc2U6JywganNvblRleHQuc3Vic3RyaW5nKDAsIDUwMCkpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gcGFyc2UgQ2xhdWRlIHJlc3BvbnNlIGFzIEpTT046ICR7cGFyc2VFcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoc2xpZGVzKSB8fCBzbGlkZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBkaWQgbm90IHJldHVybiBhIHZhbGlkIGFycmF5IG9mIHNsaWRlcycpO1xuICAgIH1cbiAgICBcbiAgICAvLyBWYWxpZGF0ZSBhbmQgc2V0IGRlZmF1bHQgbGF5b3V0IGlmIG1pc3NpbmdcbiAgICBjb25zdCB2YWxpZGF0ZWRTbGlkZXMgPSBzbGlkZXMubWFwKChzbGlkZSwgaW5kZXgpID0+IHtcbiAgICAgIGlmICghc2xpZGUgfHwgdHlwZW9mIHNsaWRlICE9PSAnb2JqZWN0Jykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc2xpZGUgYXQgaW5kZXggJHtpbmRleH1gKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gRGV0ZXJtaW5lIGRlZmF1bHQgbGF5b3V0XG4gICAgICBsZXQgZGVmYXVsdExheW91dDogc3RyaW5nO1xuICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgIGRlZmF1bHRMYXlvdXQgPSAndGl0bGUnOyAvLyBGaXJzdCBzbGlkZSBpcyBhbHdheXMgdGl0bGVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRlZmF1bHRMYXlvdXQgPSAncXVhZHJhbnQtMS0yLWxhcmdlJzsgLy8gRGVmYXVsdCBmb3Igb3RoZXIgc2xpZGVzXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIERldGVjdCBpZiBib2R5VGV4dCBpcyBpbiBidWxsZXQgcG9pbnQgZm9ybWF0IChtdWx0aXBsZSBsaW5lcylcbiAgICAgIGNvbnN0IGJvZHlUZXh0ID0gc2xpZGUuYm9keVRleHQgfHwgJyc7XG4gICAgICBjb25zdCBpc0J1bGxldEZvcm1hdCA9IGJvZHlUZXh0LnNwbGl0KCdcXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSkubGVuZ3RoID4gMTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb3ZlcmxpbmU6IHNsaWRlLm92ZXJsaW5lIHx8ICcnLFxuICAgICAgICB0aXRsZTogc2xpZGUudGl0bGUgfHwgJycsXG4gICAgICAgIGJvZHlUZXh0OiBib2R5VGV4dCxcbiAgICAgICAgbGF5b3V0OiBzbGlkZS5sYXlvdXQgfHwgZGVmYXVsdExheW91dCxcbiAgICAgICAgLy8gU2V0IHVzZUJ1bGxldHMgdG8gdHJ1ZSBpZiBjb250ZW50IGlzIGluIGJ1bGxldCBmb3JtYXQsIG9yIGlmIGV4cGxpY2l0bHkgc2V0XG4gICAgICAgIHVzZUJ1bGxldHM6IHNsaWRlLnVzZUJ1bGxldHMgIT09IHVuZGVmaW5lZCA/IHNsaWRlLnVzZUJ1bGxldHMgOiBpc0J1bGxldEZvcm1hdCxcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvLyBTZXQgb3ZlcmxpbmUgb24gYWxsIHNsaWRlcyB0byBtYXRjaCB0aXRsZSBzbGlkZSdzIHRpdGxlXG4gICAgY29uc3QgdGl0bGVTbGlkZVRpdGxlID0gdmFsaWRhdGVkU2xpZGVzWzBdPy50aXRsZSB8fCAnJztcbiAgICB2YWxpZGF0ZWRTbGlkZXMuZm9yRWFjaCgoc2xpZGUpID0+IHtcbiAgICAgIHNsaWRlLm92ZXJsaW5lID0gdGl0bGVTbGlkZVRpdGxlO1xuICAgIH0pO1xuXG4gICAgLy8gSWYgbW9yZSB0aGFuIDUgc2xpZGVzLCBlbnN1cmUgaW50cm8gKHNsaWRlIDIpIGFuZCBUT0MgKHNsaWRlIDMpIGV4aXN0XG4gICAgaWYgKHZhbGlkYXRlZFNsaWRlcy5sZW5ndGggPiA1KSB7XG4gICAgICBjb25zdCBzbGlkZTIgPSB2YWxpZGF0ZWRTbGlkZXNbMV07IC8vIFNsaWRlIDIgKGluZGV4IDEpXG4gICAgICBjb25zdCBzbGlkZTMgPSB2YWxpZGF0ZWRTbGlkZXNbMl07IC8vIFNsaWRlIDMgKGluZGV4IDIpXG4gICAgICBcbiAgICAgIC8vIEVuc3VyZSBzbGlkZSAyIGlzIGFuIGludHJvIHNsaWRlXG4gICAgICBpZiAoIXNsaWRlMiB8fCBzbGlkZTIubGF5b3V0ICE9PSAnaW50cm8nKSB7XG4gICAgICAgIC8vIENyZWF0ZSBpbnRybyBzbGlkZSB3aXRoIHN1bW1hcnkgLSBDbGF1ZGUgc2hvdWxkIGhhdmUgY3JlYXRlZCB0aGlzLFxuICAgICAgICAvLyBidXQgaWYgbm90LCB3ZSdsbCBjcmVhdGUgYSBwbGFjZWhvbGRlciB0aGF0IG5lZWRzIG1hbnVhbCBlZGl0aW5nXG4gICAgICAgIGNvbnN0IGludHJvU2xpZGUgPSB7XG4gICAgICAgICAgb3ZlcmxpbmU6IHRpdGxlU2xpZGVUaXRsZSxcbiAgICAgICAgICB0aXRsZTogJycsXG4gICAgICAgICAgYm9keVRleHQ6IHNsaWRlMj8uYm9keVRleHQgfHwgJ1NhbW1hbmZhdHRuaW5nIGF2IHByZXNlbnRhdGlvbmVuIGtvbW1lciBow6RyLi4uJyxcbiAgICAgICAgICBsYXlvdXQ6ICdpbnRybycgYXMgY29uc3QsXG4gICAgICAgICAgdXNlQnVsbGV0czogZmFsc2UsXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvLyBSZXBsYWNlIHNsaWRlIDIgd2l0aCBpbnRybyBzbGlkZSwgb3IgaW5zZXJ0IGlmIG1pc3NpbmdcbiAgICAgICAgaWYgKHNsaWRlMikge1xuICAgICAgICAgIHZhbGlkYXRlZFNsaWRlc1sxXSA9IGludHJvU2xpZGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFsaWRhdGVkU2xpZGVzLnNwbGljZSgxLCAwLCBpbnRyb1NsaWRlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBFbnN1cmUgc2xpZGUgMyBpcyBhIFRPQyBzbGlkZSAoYWZ0ZXIgaW50cm8pXG4gICAgICAvLyBHZXQgdGl0bGVzIGZyb20gXCJhdmRlbGFyZVwiIHNsaWRlcyBmb3IgVE9DIChzZWN0aW9uIGRpdmlkZXJzKVxuICAgICAgLy8gU2tpcCB0aXRsZSBzbGlkZSAoaW5kZXggMCkgYW5kIGludHJvIHNsaWRlIChpbmRleCAxKSwgdGhlbiBmaWx0ZXIgZm9yIFwiYXZkZWxhcmVcIiBsYXlvdXQgc2xpZGVzXG4gICAgICBjb25zdCB0b2NUaXRsZXMgPSB2YWxpZGF0ZWRTbGlkZXNcbiAgICAgICAgLnNsaWNlKDIpIC8vIFNraXAgdGl0bGUgc2xpZGUgYW5kIGludHJvIHNsaWRlXG4gICAgICAgIC5maWx0ZXIoc2xpZGUgPT4gc2xpZGUubGF5b3V0ID09PSAnYXZkZWxhcmUnKVxuICAgICAgICAubWFwKHNsaWRlID0+IHNsaWRlLnRpdGxlKVxuICAgICAgICAuZmlsdGVyKHRpdGxlID0+IHRpdGxlLnRyaW0oKSk7XG5cbiAgICAgIC8vIElmIG5vIGF2ZGVsYXJlIHNsaWRlcyBmb3VuZCwgZmFsbCBiYWNrIHRvIGFsbCBzbGlkZSB0aXRsZXMgKGV4Y2VwdCB0aXRsZSBhbmQgaW50cm8gc2xpZGVzKVxuICAgICAgY29uc3QgZmluYWxUb2NUaXRsZXMgPSB0b2NUaXRsZXMubGVuZ3RoID4gMCBcbiAgICAgICAgPyB0b2NUaXRsZXMgXG4gICAgICAgIDogdmFsaWRhdGVkU2xpZGVzXG4gICAgICAgICAgICAuc2xpY2UoMikgLy8gU2tpcCB0aXRsZSBzbGlkZSBhbmQgaW50cm8gc2xpZGVcbiAgICAgICAgICAgIC5tYXAoc2xpZGUgPT4gc2xpZGUudGl0bGUpXG4gICAgICAgICAgICAuZmlsdGVyKHRpdGxlID0+IHRpdGxlLnRyaW0oKSk7XG5cbiAgICAgIC8vIENoZWNrIGlmIHNsaWRlIDMgaXMgYWxyZWFkeSBhIFRPQyBzbGlkZVxuICAgICAgY29uc3QgaXNUb2NTbGlkZSA9IHNsaWRlMz8udGl0bGUgPT09ICdJbm5laMOlbGxzZsO2cnRlY2tuaW5nJyB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICBzbGlkZTM/LmxheW91dCA9PT0gJ3RvYyc7XG5cbiAgICAgIGlmICghc2xpZGUzIHx8ICFpc1RvY1NsaWRlKSB7XG4gICAgICAgIC8vIENyZWF0ZSBUT0Mgc2xpZGUgd2l0aCBzYW1lIHN0cnVjdHVyZSBhcyB2YWxpZGF0ZWRTbGlkZXNcbiAgICAgICAgY29uc3QgdG9jU2xpZGUgPSB7XG4gICAgICAgICAgb3ZlcmxpbmU6IHRpdGxlU2xpZGVUaXRsZSwgLy8gVXNlIHRpdGxlIHNsaWRlJ3MgdGl0bGUgYXMgb3ZlcmxpbmVcbiAgICAgICAgICB0aXRsZTogJ0lubmVow6VsbHNmw7ZydGVja25pbmcnLFxuICAgICAgICAgIGJvZHlUZXh0OiBmaW5hbFRvY1RpdGxlcy5qb2luKCdcXG4nKSxcbiAgICAgICAgICBsYXlvdXQ6ICd0b2MnIGFzIGNvbnN0LFxuICAgICAgICAgIHVzZUJ1bGxldHM6IGZhbHNlLCAvLyBUT0MgdXNlcyBudW1iZXJlZCBsaXN0LCBub3QgYnVsbGV0c1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFJlcGxhY2Ugc2xpZGUgMyB3aXRoIFRPQyBzbGlkZSwgb3IgaW5zZXJ0IGlmIG1pc3NpbmdcbiAgICAgICAgaWYgKHNsaWRlMykge1xuICAgICAgICAgIHZhbGlkYXRlZFNsaWRlc1syXSA9IHRvY1NsaWRlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhbGlkYXRlZFNsaWRlcy5zcGxpY2UoMiwgMCwgdG9jU2xpZGUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgVE9DIHNsaWRlIGNvbnRlbnRcbiAgICAgICAgc2xpZGUzLmJvZHlUZXh0ID0gZmluYWxUb2NUaXRsZXMuam9pbignXFxuJyk7XG4gICAgICAgIHNsaWRlMy5sYXlvdXQgPSAndG9jJztcbiAgICAgICAgc2xpZGUzLnVzZUJ1bGxldHMgPSBmYWxzZTsgLy8gVE9DIHVzZXMgbnVtYmVyZWQgbGlzdCwgbm90IGJ1bGxldHNcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzbGlkZXM6IHZhbGlkYXRlZFNsaWRlcyB9KTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdlbmVyYXRlLXNsaWRlcyBBUEk6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byBnZW5lcmF0ZSBzbGlkZXMnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJBbnRocm9waWMiLCJhbnRocm9waWMiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiQU5USFJPUElDX0FQSV9LRVkiLCJQT1NUIiwicmVxdWVzdCIsIm5vdGVzIiwiYnJpZWYiLCJzbGlkZUFtb3VudE1vZGUiLCJzbGlkZUFtb3VudE1pbiIsInNsaWRlQW1vdW50TWF4IiwianNvbiIsInRyaW0iLCJlcnJvciIsInN0YXR1cyIsInNsaWRlQ291bnRJbnN0cnVjdGlvbiIsInN1bW1hcnlJbnN0cnVjdGlvbiIsInByb21wdCIsImZ1bGxQcm9tcHQiLCJtZXNzYWdlIiwibW9kZWxzVG9UcnkiLCJsYXN0RXJyb3IiLCJtb2RlbCIsIm1lc3NhZ2VzIiwiY3JlYXRlIiwibWF4X3Rva2VucyIsInJvbGUiLCJjb250ZW50IiwiY29uc29sZSIsImxvZyIsIndhcm4iLCJFcnJvciIsInR5cGUiLCJqc29uVGV4dCIsInRleHQiLCJzdGFydHNXaXRoIiwicmVwbGFjZSIsImpzb25NYXRjaCIsIm1hdGNoIiwic2xpZGVzIiwiSlNPTiIsInBhcnNlIiwicGFyc2VFcnJvciIsInN1YnN0cmluZyIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsInZhbGlkYXRlZFNsaWRlcyIsIm1hcCIsInNsaWRlIiwiaW5kZXgiLCJkZWZhdWx0TGF5b3V0IiwiYm9keVRleHQiLCJpc0J1bGxldEZvcm1hdCIsInNwbGl0IiwiZmlsdGVyIiwibGluZSIsIm92ZXJsaW5lIiwidGl0bGUiLCJsYXlvdXQiLCJ1c2VCdWxsZXRzIiwidW5kZWZpbmVkIiwidGl0bGVTbGlkZVRpdGxlIiwiZm9yRWFjaCIsInNsaWRlMiIsInNsaWRlMyIsImludHJvU2xpZGUiLCJzcGxpY2UiLCJ0b2NUaXRsZXMiLCJzbGljZSIsImZpbmFsVG9jVGl0bGVzIiwiaXNUb2NTbGlkZSIsInRvY1NsaWRlIiwiam9pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/generate-slides/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@anthropic-ai"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgenerate-slides%2Froute&page=%2Fapi%2Fgenerate-slides%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgenerate-slides%2Froute.ts&appDir=%2FUsers%2Fleodrougge%2FDocuments%2FSlide%20Generator%20v0.2%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fleodrougge%2FDocuments%2FSlide%20Generator%20v0.2&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();